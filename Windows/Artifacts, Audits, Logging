Obj
  Auditing activities
  Id actions that log
  define win logging
    config audit policy settings
    audit event ID
  Tune audit policy for anomalous activity regognition
  analyze event los for anomalous activity
  id ps logging
  
=======================================
Windows Artifacts
=======================================
Artifacts (General, major ones, not all)
  List
    UserAssist
    Windows Background Activity Moderator (BAM)
    Recycle Bin
    Prefetch
    Jump Lists
    Recent Files
    Browser Artifacts
  Track user of system activity with them
  DEF:
    Objects or areas within computer system that contain info relevent to activities performed on the system by a user
    Anything left behind on OS from code execution
      Artifacts good for forensic analysis
      Allows for historic analysis on machine
        Can look for persistance with artifacts, just need to now heere to look
        
Get User SID
------------
  What users are we looking at, use SID to find
    When going to machine get draw every account thats logged into machine
  Many artifacts require operator to use a Security Identifier (SID)
    to dig in user specific registry locations to enumerate the artifact info.
        get-wmiobject win32_useraccount | select name,sid (PowerShell)
          get-wmiobject shows local / domain Users and SID
        Get-LocalUser | select Name,SID (PowerShell)
          Get-localUser shows local users and SID on system
        wmic useraccount get name,sid (CMD.EXE ONLY)
          wmic useraccount will show local users and SID
        
USERASSIST
----------
  Looking for shortcut
  Userrassist uslly only for current user
  To check all users:
    HKU ... ??
    get-item 'registry::hkey_users\*\software\microsoft\windows\currentversion\explorer\userassist\{GUID (these 2 same aross machine)}\Count'
      or get-itemproperty _______ (expands it out)
  UserAssit registry key
    tracks the GUI-based programs that were ran by particulat user
    HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\UserAssist\{GUID}\Count\
      Encoded in ROT13
    GUID
      represents a perticular file extension
      2 same ones for windows:
        CEBFF5CD-ACE2-4F4F-9178-9926F41749EA 
          A list of applications, files, links, and other objects that have been accessed
        F4E57C4B-2036-45F0-A9AB-443BCFE33D9F 
          Lists the Shortcut Links used to start programs
        Can be decoded with cyberchef (ROT13)
  View executable files run
    Get-ItemProperty 'REGISTRY::HKEY_USERS\*\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\UserAssist\{CEBFF5CD-ACE2-4F4F-9178-9926F41749EA}\Count'
    Get-ItemProperty "Registry::Hkey_Users\*\Software\Microsoft\Windows\CurrentVersion\Explorer\UserAssist\{CEBFF5CD-ACE2-4F4F-9178-9926F41749EA}\Count"
      all users
    Get-ItemProperty "HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\UserAssist\{CEBFF5CD-ACE2-4F4F-9178-9926F41749EA}\Count"
      one, current, user  
 View shortcut files executes
    Get-ItemProperty 'REGISTRY::HKEY_USERS\*\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\UserAssist\{F4E57C4B-2036-45F0-A9AB-443BCFE33D9F}\Count'
  
lmk
  good for persistance
  shortcut to program
    can be used to run program and othe things after

WINDOWS BACKGROUND ACTIVITY MODERATOR (BAM)
------------------------------------------
  BAM is windows service
    Controls activity of background applications
  Get-Itemproperty 'HKLM:\SYSTEM\CurrentControlSet\Services\bam\UserSettings\*'
    (Windows 1709 & 1803)
  Get-Itemproperty 'HKLM:\SYSTEM\CurrentControlSet\Services\bam\state\UserSettings\*'
    (Windows 1809 and newer)
  
RECYCLE BIN
-----------
  Important location on windows file system
   can help accomplish forensic investigation
  gci 'C:\$RECYCLE.BIN' -Recurse -Verbose -Force | select *
  gci 'C:\$RECYCLE.BIN' -Recurse -Force
  
PREFETCH
--------
  Prefetch files are created by operating system when application is run from specific location for first time
  gci -Path 'C:\Windows\Prefetch' -ErrorAction Continue | select * | select -first 5

JUMP LISTS
-----------
  Windows 7-10 taskbar
    made to allow users to 'jump' / access items the have frequently or recently used quickly and easily
  gci -Recurse C:\Users\*\AppData\Roaming\Microsoft\Windows\Recent -ErrorAction Continue | select FullName, LastAccessTime
  
RECENT FILES
------------
  Registry Key
    track the last files and foldes opened and is used to populate data in “Recent” menus of the Start menu.
    Will track overall order of the last 150 files or folders opened
  List files in recent docs
    gci 'REGISTRY::HKEY_USERS\*\Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs'
  Convert File Hex to Unicode
    [System.Text.Encoding]::Unicode.GetString((gp "REGISTRY::HKEY_USERS\*\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs\.txt")."0")
  Convert all of a users values from HEX to Unicode
    Get-Item "REGISTRY::HKEY_USERS\*\Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs\.txt" | select -Expand property | ForEach-Object { [System.Text.Encoding]::Default.GetString((Get-ItemProperty -Path "REGISTRY::HKEY_USERS\*\Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs\.txt" -Name $_).$_)}


AUDITING
===============
  Auditing generally used to see where network is at, see where complicance is to see vuln
  See what is the weakness in netowork
    this can determine if threat has to work hard / be creative to get in or not













































