Logging
==============

DEF:
  a record of performance, events, or day-to-day activities
  collection of data that defines the time an event occurred on a computer
  raw, uncompressed data

Most linux logging is controlled by syslog or journald
  syslog
    standward logginf system protocol defined by RFC 5424
    RFC 5424
    text-based
    universal across Unix-like
    default
  journald
    unique to systemd
    systemd moduele
    binary files
    read w/ journalctl
    can output in various fromats
  Both store in /var/log/...
    difference in data each program generates

Logging Generl:
  PROS
    remote Logging
      main system crashes
      becmes compromsed
    Historical analysis
      record of anamolous activity
      diagnostics of a faulure
  CONS
    logc can be cryptic
    log is not free
    logg too much/little
    *Not analyze log
    not looking at right logs
    Time normalization
    confimration of critical systems uage    

  Log Types
    Authentication
      /var/log/auth.log - 
        Authentication related events
        like catchall for all auth attempts..?
          ie ssh service accepting passwords
          session exists inbetween the new session and removes session lines
        can accept key ie public key, or passwords
      /var/run/utmp - 
        Users currently logged in
      /var/log/wtmp - 
        History file for utmp
      /var/log/btmp - 
        Failed login attempts
      login events
      elevate priv
      anytime need cred...
    Application
      apache -
        Web Server (dir)
      apt - 
        Package Manager (dir)
          for when you install a package / app w/ apt
      /var/log/mysql.log
    System
      /var/log/messages - 
        Legacy Catch all
      /var/log/syslog - 
        Ubuntu/Debian Catch all
      dmesg  (command)
        shows a lot of hardware stuff, and some boot stuff....
        Device Messenger 
          (queires /proc/kmsg)
          Anything get info from kernel from / about system
        Kernel Ring Buffer - 
          Never fills
        First logs generated by the system
      
  Check Logs
    tail /var/log/auh.og
      
    1. last -f /var/run/utmp
        -f specift file
    2. laft -f /vat/log/wtmp
        last be default checks this file...
    3. sudo last -f /var/log/vtmp
        make sure nobody attempted to use username
      
   Locations
    Logs
      /var/log
        sotores logs in human-readable format text documents
        most logs here
        /messages
    Config File
      /etc/rsyslog.cong
        syslog logs configured here
        for SysV system
          systemd uses journald
    System
      /usr/sbin/rsyslog
        Logging Daemon
      
  Logging Daemon
  --------------
    Location
      /usr/sbin/rsyslog
    Syslog configuration standard
      contains (selectors actions)
        Selectors
          Facility.severity
             log entries follow standard (facility.severity)
             Facility
                what program, or part of system, lof is from
                source, event, that generated log
             severity
                urgency
                0-7 (for out examples)
           action
              /path/to/log/location
              where lof is stored
              any action taken on event before storae
                ie send to remote server
      shows rules portion of /etc/rsyslog.conf
        tail -n40 /etc/rsyslog.conf
         Rsyslog stuff
          *.=(level) When loggig a severity, it will log that level, and anything above it
          @ = udp
          @@ = tcp
            
    User Space Daemon
      Reads message written to /dev/log
      formats and stores them based on /etc/rsyslog.cong rules
      syslog() via libc
      kernel ring buffer
      audit records via audit subsystem (auditd)
      
   
Log Enumeraton / Management
---------------------------
Best Practice
  good / meaningful naming
  seperate logs logically and precedence
  Sync time across network
  control log access
Utilize cron jobs / scrits
  logrotate
    /etc/logrotate.conf
    how large to let files get
    how long to keep them
      what to do with logs after time ie zip
  
 Useful Logging Commands
 -----------------------
 
  jounrelctl 
    journalctl -e
      shows logs of recently....
    journalctl --list-boots
      shows log of boots
        highlist boot id
          pase into commandline and get logs for boot session
            filter 
              journalctl -u ssh.service
                see logs pertaining to that unit (remember systemd has the units)
                
    jornalctl --li [tab]
      show lists
  
      
  jq play
  
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
jmupbox in da cloud
